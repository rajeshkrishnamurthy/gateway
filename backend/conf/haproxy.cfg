global
  daemon
  maxconn 2048

defaults
  mode http
  option httplog
  timeout connect 5s
  timeout client 30s
  timeout server 30s

frontend sms_gateway
  bind *:8080
  default_backend sms_backends

backend sms_backends
  balance roundrobin
  option httpchk GET /metrics
  server sms1 127.0.0.1:18080 check
  server sms2 127.0.0.1:18081 check
  server sms3 127.0.0.1:18082 check

frontend push_gateway
  bind *:8081
  default_backend push_backends

backend push_backends
  balance roundrobin
  option httpchk GET /metrics
  server push1 127.0.0.1:19080 check
  server push2 127.0.0.1:19081 check
  server push3 127.0.0.1:19082 check

listen haproxy_stats
  bind *:8404
  stats enable
  stats uri /stats
  stats refresh 5s
